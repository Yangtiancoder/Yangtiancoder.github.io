---
layout: post
title: 人工神经网络
category: blog
tags: [ 机器学习, 深度学习]
description: 基础概念和主要方法介绍。
---

前言：最近十多年来，人工神经网络的研究工作不断深入，已经取得了很大的进展，其在模式识别、智能机器人、自动控制、预测估计、生物、医学、经济等领域已成功地解决了许多现代计算机难以解决的实际问题，表现出了良好的智能特性。 

## 神经元模型

MP神经元模型是1943年，由WarrenMcCulloch和WalterPitts提出的。在这个模型中，神经元接收到来自n个其他神经元传递过来的输入信号，这些输入信号通过带权重的连接进行传递，神经元接收到的总输入值将与神经元的阈值进行比较，然后通过“激活函数”处理以产生神经元的输出。如图所示：

![](https://github.com/Yangtiancoder/Yangtiancoder.github.io/blob/master/assets/images/ANN1.png?raw=true)

注意：理想中的激活函数是阶跃函数，但是由于阶跃函数具有不光滑、不连续等性质，所以经常采用Sigmoid函数作为激活函数，Sigmoid函数也被称为挤压函数。

把许多个这样的神经元模型按照一定的层次连接起来，就得到了神经网络。 

## 感知机和多层网络 

感知机由两层神经元组成，输入层接受外界输入信号后传递给输出层，输出层是M-P神经元，亦称“阈值逻辑单元”。  

除此之外，注意到y=f(xTw−θ)=f(∑wixi−θ)，阈值θ可以看做固定输入为-1.0的”哑结点”其对应的权重为wn+1,这样权重和阈值的学习可以统一为权重学习。 

为得到可接受的权向量，我们会从随机的权值开始，反复地应用这个感知机到每个训练样例，只要它误分类样例就修改感知机的权值。重复这个过程，直到感知机正确分类所有的样例。每一步根据感知机训练法则(perceptron training rule)来修改权值，也就是修改与输入 xi 对应的权 wi，法则如下：

![](https://github.com/Yangtiancoder/Yangtiancoder.github.io/blob/master/assets/images/ANN2.png?raw=true)
  
wi←wi+Δwi  

Δwi=η(t−o)xi  

这里 t 是当前训练样例的目标输出，o是感知机的输出，η是一个正的常数称为学习速率(learning rate)。学习速率的作用是缓和每一步调整权的程度，它通常被设为一个小的数值（例如 0.1），而且有时会使其随着权调整次数的增加而衰减。  

需要注意的是，感知机只有输出层神经元进行激活函数处理，即只拥有一层功能神经元，其学习能力非常有限。可以证明，若两类模式是线性可分的，即存在一个线性超平面能将他们分开，即感知机的学习过程一定会收敛。

要解决非线性问题，需要考虑多层功能神经元。输入层和输出层之间的一层神经元，被称为隐含层，隐含层和输出层都是拥有激活函数的神经元。如图：  

![](https://github.com/Yangtiancoder/Yangtiancoder.github.io/blob/master/assets/images/ANN3.png?raw=true)  

一般的，每层神经元与下一层神经元全互联，神经元不存在同层链接，也不存在跨层链接，这样的神经网络结构通常称为“多层前馈神经网络”。如图：

![](https://github.com/Yangtiancoder/Yangtiancoder.github.io/blob/master/assets/images/ANN4.png?raw=true)  

## 误差逆传播算法

定义：误差逆传播算法（backpropagation BP算法）是迄今最成功的的神经网络算法。显示任务中使用神经网络时，大多是在使用BP算法进行训练。不仅适用于多层前馈神经网络，还可以用于其他类型的神经网络，训练递归。

其主要思想是：

1.将训练集数据输入到ANN的输入层，经过隐藏层，最后达到输出层并输出结果，这是ANN的前向传播过程；

2.由于ANN的输出结果与实际结果有误差，则计算估计值与实际值之间的误差，并将该误差从输出层向隐藏层反向传播，直至传播到输入层；

3.在反向传播的过程中，根据误差调整各种参数的值；不断迭代上述过程，直至收敛。

至于公式推导，可以参考西瓜书上的公式推导，主要采用了梯度下降的策略，在迭代的每一轮中采用广义的感知机学习规则对参数进行更新估计，任意参数v的更新估计公式为  v←v+Δv   

工作流程：对于每个训练样例，BP算法执行以下操作，先将输入事例提供给输入神经元，然后逐层将信号前传，直到产生输出层的结果；然后计算输出层的误差，再将误差误差你想传播至隐层神经元，最后根据隐层神经元的误差来对连接权和阈值进行调整，该迭代过程循环进行，直到达到某些停止条件为之。

## 深度学习与人工神经网络

 Deep learning与传统的神经网络之间有相同的地方也有很多不同。

 二者的相同在于deep learning采用了神经网络相似的分层结构，系统由包括输入层、隐层（多层）、输出层组成的多层网络，只有相邻层节点之间有连接，同一层以及跨层节点之间相互无连接，每一层可以看作是一个logistic regression模型；这种分层结构，是比较接近人类大脑的结构的。  

 ![](https://github.com/Yangtiancoder/Yangtiancoder.github.io/blob/master/assets/images/ANN5.png?raw=true)  

 而为了克服神经网络训练中的问题，DL采用了与神经网络很不同的训练机制。传统神经网络（这里作者主要指前向神经网络）中，采用的是BP的方式进行，简单来讲就是采用迭代的算法来训练整个网络，随机设定初值，计算当前网络的输出，然后根据当前输出和label之间的差去改变前面各层的参数，直到收敛（整体是一个梯度下降法）。而deep learning整体上是一个layer-wise的训练机制。这样做的原因是因为，如果采用BP的机制，对于一个deepnetwork（7层以上），残差传播到最前面的层已经变得太小，出现所谓的gradient diffusion（梯度扩散）。

**传统神经网络的训练方法为什么不能用在深度神经网络**

  BP算法作为传统训练多层网络的典型算法，实际上对仅含几层网络，该训练方法就已经很不理想。深度结构（涉及多个非线性处理单元层）非凸目标代价函数中普遍存在的局部最小是训练困难的主要来源。  

**BP算法存在的问题**  

 （1）梯度越来越稀疏：从顶层越往下，误差校正信号越来越小；

 （2）收敛到局部最小值：尤其是从远离最优区域开始的时候（随机值初始化会导致这种情况的发生）；

 （3）一般，我们只能用有标签的数据来训练：但大部分的数据是没标签的，而大脑可以从没有标签的的数据中学习；

## deep learning训练过程

如果对所有层同时训练，时间复杂度会太高；如果每次训练一层，偏差就会逐层传递。这会面临跟上面监督学习中相反的问题，会严重欠拟合（因为深度网络的神经元和参数太多了）。

简单的说，分为两步，一是每次训练一层网络，二是调优，使原始表示x向上生成的高级表示r和该高级表示r向下生成的x'尽可能一致。方法是：

 1）首先逐层构建单层神经元，这样每次都是训练一个单层网络。

 2）当所有层训练完后，Hinton使用wake-sleep算法进行调优。

将除最顶层的其它层间的权重变为双向的，这样最顶层仍然是一个单层神经网络，而其它层则变为了图模型。向上的权重用于“认知”，向下的权重用于“生成”。然后使用Wake-Sleep算法调整所有的权重。让认知和生成达成一致，也就是保证生成的最顶层表示能够尽可能正确的复原底层的结点。比如顶层的一个结点表示人脸，那么所有人脸的图像应该激活这个结点，并且这个结果向下生成的图像应该能够表现为一个大概的人脸图像。Wake-Sleep算法分为醒（wake）和睡（sleep）两个部分。

 **1）wake阶段：**认知过程，通过外界的特征和向上的权重（认知权重）产生每一层的抽象表示（结点状态），并且使用梯度下降修改层间的下行权重（生成权重）。也就是“如果现实跟我想象的不一样，改变我的权重使得我想象的东西就是这样的”。

 **2）sleep阶段：**生成过程，通过顶层表示（醒时学得的概念）和向下权重，生成底层的状态，同时修改层间向上的权重。也就是“如果梦中的景象不是我脑中的相应概念，改变我的认知权重使得这种景象在我看来就是这个概念”。

**deep learning训练过程具体如下**

1）使用自下上升非监督学习（就是从底层开始，一层一层的往顶层训练）：

   采用无标定数据（有标定数据也可）分层训练各层参数，这一步可以看作是一个无监督训练过程，是和传统神经网络区别最大的部分（这个过程可以看作是feature learning过程）：

   具体的，先用无标定数据训练第一层，训练时先学习第一层的参数（这一层可以看作是得到一个使得输出和输入差别最小的三层神经网络的隐层），在学习得到第n-1层后，将n-1层的输出作为第n层的输入，训练第n层，由此分别得到各层的参数；

2）自顶向下的监督学习（就是通过带标签的数据去训练，误差自顶向下传输，对网络进行微调）：

   基于第一步得到的各层参数；第一步类似神经网络的随机初始化初值过程，由于DL的第一步不是随机初始化，而是通过学习输入数据的结构得到的，因而这个初值更接近全局最优，从而能够取得更好的效果；所以deep learning效果好很大程度上归功于第一步的过程。








**参考资料**

<https://blog.csdn.net/zouxy09/article/details/8775518>  

《机器学习》-周志华

